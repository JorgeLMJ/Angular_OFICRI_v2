  <!-- src/app/components/dashboard/documento/documento.component.html -->
  <div class="container mt-4">
    <!-- Encabezado -->
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2 class="text-primary">
        <i class="bi bi-file-earmark-text me-2"></i> Gesti贸n de Documentos
      </h2>
      <button class="btn btn-success" (click)="nuevoDocumento()">
        <i class="bi bi-plus-circle me-2"></i> Nuevo Documento
      </button>
    </div>

    <!-- Buscador -->
    <div class="mb-4">
      <div class="input-group">
        <span class="input-group-text bg-primary text-white">
          <i class="bi bi-search"></i>
        </span>
        <input 
          type="text" 
          class="form-control" 
          placeholder="Buscar por n掳 oficio, nombre, DNI, delito, situaci贸n..." 
          [(ngModel)]="searchTerm" 
          (input)="goToPage(1)">
      </div>
    </div>

    <!-- Grid de Cards -->
    <div class="row g-4">
      <div class="col-12 col-md-6 col-lg-4" *ngFor="let doc of paginatedDocumentos; trackBy: trackById">
        <div class="card shadow-sm h-100"> <!--  Eliminado border-0 -->
          <div class="card-header bg-light d-flex justify-content-between align-items-start"> <!--  Cambiado a align-items-start -->
            <div>
              <h5 class="mb-1 text-primary">Registro: {{ doc.nro_registro }}</h5> <!--  Cambiado a mb-1 -->
              <p class="mb-1 text-muted small">
                <i class="bi bi-file-earmark me-1"></i> Oficio: {{ doc.nroOficio }} |
                <i class="bi bi-person me-1"></i> {{ doc.nombres }} {{ doc.apellidos }}
              </p>
              <p class="mb-0">
                <strong>Situaci贸n:</strong> {{ doc.situacion }}
              </p>
            </div>
            <div class="btn-group flex-shrink-0" role="group"> <!--  Agregado flex-shrink-0 -->
              <button type="button" class="btn btn-sm btn-outline-warning" (click)="editarDocumento(doc.id!)"><i class="bi bi-pencil-square"></i></button>
              <button type="button" class="btn btn-sm btn-outline-info" (click)="vistaPrevia(doc)"><i class="bi bi-eye"></i></button>
            </div>
          </div>
          <div class="card-body">
            <!-- SECCIN 1: OFICIO (AMPLIADA) -->
            <div class="mb-3"> <!--  Reducido margen -->
              <h6 class="text-primary mb-2"><i class="bi bi-file-earmark me-2"></i> Oficio</h6> <!--  Reducido margen -->
              <div class="row">
                <div class="col-12 mb-2"><strong><i class="bi bi-hash me-2 text-primary"></i>N掳 Oficio:</strong> {{ doc.nroOficio }}</div>
                <div class="col-12 mb-2"><strong><i class="bi bi-card-text me-2 text-primary"></i>Asunto:</strong> {{ doc.asunto }}</div>
                <div class="col-12 mb-2"><strong><i class="bi bi-building me-2 text-primary"></i>Procedencia:</strong> {{ doc.procedencia }}</div>
                <div class="col-12 mb-2"><strong><i class="bi bi-calendar-date me-2 text-primary"></i>Fecha Ingreso:</strong> {{ formatDate(doc.fechaIngreso) }}</div>
              </div>
            </div>

            <!-- SECCIN 2: EXAMINADO -->
            <div class="mb-3">
              <h6 class="text-primary mb-2"><i class="bi bi-person me-2"></i> Examinado</h6>
              <div class="row">
                <div class="col-12 mb-2"><strong><i class="bi bi-person me-2 text-primary"></i>Nombre:</strong> {{ doc.nombres }} {{ doc.apellidos }}</div>
                <div class="col-12 mb-2"><strong><i class="bi bi-credit-card me-2 text-primary"></i>DNI:</strong> {{ doc.dni }}</div>
                <div class="col-12 mb-2"><strong><i class="bi bi-exclamation-triangle me-2 text-primary"></i>Delito/Infracci贸n:</strong> {{ doc.delitoInfraccion }}</div>
              </div>
            </div>

            <!-- SECCIN 3: ACTA DE TOMA DE MUESTRA -->
            <div class="mb-3">
              <h6 class="text-primary mb-2"><i class="bi bi-droplet me-2"></i>И Acta de Toma de Muestra</h6>
              <div class="row">
                <div class="col-12 mb-2"><strong><i class="bi bi-calendar-check me-2 text-primary"></i>Fecha Acta:</strong> {{ formatDate(doc.fechaActa) || 'N/A' }}</div>
                <div class="col-12 mb-2"><strong><i class="bi bi-clock-history me-2 text-primary"></i>Hora Muestra:</strong> {{ doc.horaTomaMuestra || 'N/A' }}</div>
                <div class="col-12 mb-2"><strong><i class="bi bi-droplet me-2 text-primary"></i>Tipo Muestra:</strong> {{ doc.tipoMuestra || 'N/A' }}</div>
                <div class="col-12 mb-2"><strong><i class="bi bi-person-vcard me-2 text-primary"></i>Conduce:</strong> {{ doc.personaQueConduce || 'N/A' }}</div>
              </div>
            </div>

            <!-- ANEXOS -->
            <div *ngIf="getAnexosSeleccionados(doc.anexos) as listaAnexos">
              <div *ngIf="listaAnexos.length > 0">
                <h6 class="text-primary mb-2"><i class="bi bi-paperclip me-2"></i> Anexos</h6>
                <div class="d-flex flex-wrap gap-1">
                  <span *ngFor="let anexo of listaAnexos" class="badge bg-secondary fw-normal">
                    {{ anexo }}
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Sin resultados -->
    <div class="text-center py-5" *ngIf="filteredDocumentos.length === 0">
      <i class="bi bi-search display-4 text-muted mb-3"></i>
      <h5 class="text-muted">No se encontraron documentos</h5>
    </div>

    <!-- Paginaci贸n -->
    <div class="d-flex justify-content-center mt-4" *ngIf="filteredDocumentos.length > 0">
      <nav>
        <ul class="pagination">
          <li class="page-item" [class.disabled]="currentPage === 1"><button class="page-link" (click)="prevPage()">Anterior</button></li>
          <li class="page-item" *ngFor="let page of getPageNumbers(); trackBy: trackByPage"><button class="page-link" [class.active]="page === currentPage" (click)="goToPage(page)">{{ page }}</button></li>
          <li class="page-item" [class.disabled]="currentPage === totalPages"><button class="page-link" (click)="nextPage()">Siguiente</button></li>
        </ul>
      </nav>
    </div>
  </div>

  <!-- Modal para visualizar el PDF -->
  <div class="modal fade" id="pdfModal" #pdfModal tabindex="-1" aria-labelledby="pdfModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <!--  CABECERA REDUCIDA Y TTULO DINMICO -->
        <div class="modal-header bg-primary text-white" style="padding: 0.25rem 0.75rem; min-height: 2.25rem;">
          <h5 class="modal-title" id="pdfModalLabel">{{ pdfModalTitle }}</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body p-0" style="height: 100vh; overflow: hidden;">
          <iframe *ngIf="currentPdfUrl" 
                  [src]="currentPdfUrl | safeUrl" 
                  width="100%" 
                  height="100%" 
                  frameborder="0"
                  style="border: none; background: #fff; overflow: hidden;">
          </iframe>
        </div>
      </div>
    </div>
  </div>